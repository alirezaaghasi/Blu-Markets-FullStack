/* ===== BLU MARKETS v9.8 - FINANCIAL UI ===== */

:root {
  --bg-primary: #0f1419;
  --bg-secondary: #151c24;
  --bg-tertiary: #1c252e;
  --bg-elevated: #232d38;
  --accent: #3d7fff;
  --accent-muted: rgba(61, 127, 255, 0.12);
  --accent-border: rgba(61, 127, 255, 0.25);
  --text-primary: #e6edf3;
  --text-secondary: #8b949e;
  --text-muted: #656d76;
  --border: rgba(255, 255, 255, 0.08);
  --border-hover: rgba(255, 255, 255, 0.12);
  --success: #3fb950;
  --warning: #d29922;
  --danger: #f85149;
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.2);
  --shadow-md: 0 2px 8px rgba(0,0,0,0.25);
  --font-farsi: 'Vazirmatn', system-ui, sans-serif;
  --farsi-line-height: 1.8;
  --farsi-letter-spacing: 0.01em;
}

/* Base styles */
* { box-sizing: border-box; }
html, body { height: 100%; margin: 0; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  font-size: 14px;
  line-height: 1.5;
}

/* Scrollbar */
::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--bg-elevated); border-radius: 4px; border: 2px solid var(--bg-secondary); }
::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

/* Layout */
.container { height: 100vh; display: grid; grid-template-columns: 400px 1fr; gap: 1px; background: var(--border); }
.panel { background: var(--bg-secondary); overflow: hidden; display: flex; flex-direction: column; min-height: 0; }
.header { padding: 16px 20px; border-bottom: 1px solid var(--border); display: flex; align-items: flex-start; gap: 12px; }
.logo { width: 28px; height: 28px; border-radius: 6px; background: var(--accent); display: grid; place-items: center; font-weight: 600; color: white; font-size: 12px; }
.h-title { font-weight: 600; font-size: 15px; color: var(--text-primary); }
.h-sub { font-size: 12px; color: var(--text-muted); margin-top: 2px; }
.h-motto { font-size: 11px; color: var(--text-muted); margin-top: 2px; font-weight: 400; letter-spacing: 0.01em; }
.rightMeta { display: flex; flex-direction: column; align-items: flex-end; gap: 6px; }
.pill { display: inline-flex; gap: 6px; align-items: center; padding: 5px 10px; border: 1px solid var(--border); border-radius: 6px; background: var(--bg-tertiary); font-weight: 500; font-size: 11px; color: var(--text-secondary); }
.body { padding: 16px; overflow: auto; flex: 1; min-height: 0; }
.footer { padding: 14px 16px; border-top: 1px solid var(--border); background: var(--bg-tertiary); }
.row { display: flex; gap: 8px; flex-wrap: wrap; }
.stack { display: flex; flex-direction: column; gap: 0; }

/* Buttons */
.btn { appearance: none; border: 1px solid var(--border); background: var(--bg-tertiary); color: var(--text-primary); padding: 10px 16px; border-radius: 8px; font-weight: 500; cursor: pointer; font-size: 13px; transition: background 0.15s, border-color 0.15s; }
.btn:hover { background: var(--bg-elevated); border-color: var(--border-hover); }
.btn.primary { background: var(--accent); border-color: var(--accent); color: white; }
.btn.primary:hover { background: #5a93ff; border-color: #5a93ff; }
.btn.danger { background: transparent; border-color: var(--danger); color: var(--danger); }
.btn.danger:hover { background: rgba(248, 81, 73, 0.1); }
.btn:disabled { background: var(--bg-tertiary); color: var(--text-muted); border-color: var(--border); cursor: not-allowed; opacity: 0.6; }
.btn.tiny { padding: 6px 12px; font-size: 12px; border-radius: 6px; }
.btn.tiny:hover { background: var(--accent-muted); border-color: var(--accent-border); color: var(--accent); }
.btn.tiny:disabled { opacity: .35; cursor: not-allowed; background: transparent; border-color: transparent; color: var(--text-muted); }
.btn.small { padding: 6px 12px; font-size: 12px; border-radius: 6px; }

/* Inputs */
.input { width: 100%; padding: 10px 12px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-primary); color: var(--text-primary); font-weight: 400; outline: none; font-size: 14px; transition: border-color 0.15s; }
.input:focus { border-color: var(--accent); }
.input::placeholder { color: var(--text-muted); }

/* Cards */
.card { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin-bottom: 12px; }
.card h3 { margin: 0 0 12px 0; font-size: 12px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.04em; color: var(--text-muted); }
.big { font-size: 24px; font-weight: 600; font-variant-numeric: tabular-nums; color: var(--text-primary); }
.muted { color: var(--text-secondary); font-size: 12px; }

/* Grid */
.grid3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
.mini { border: 1px solid var(--border); border-radius: 10px; padding: 12px; background: var(--bg-secondary); }
.tag { font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.03em; font-weight: 500; }

/* List */
.list { display: flex; flex-direction: column; gap: 8px; }
.item { display: flex; justify-content: space-between; gap: 12px; align-items: center; padding: 12px 14px; border: 1px solid var(--border); border-radius: 10px; background: var(--bg-secondary); transition: border-color 0.15s; }
.item:hover { border-color: var(--border-hover); }
.item.assetEmpty { opacity: 0.5; }
.item.assetEmpty .asset { color: var(--text-muted); }
.asset { font-weight: 500; font-size: 14px; }
.assetActions { display: flex; justify-content: flex-end; gap: 6px; margin-top: 6px; flex-wrap: wrap; }

/* Tabs */
.tabs { display: flex; gap: 4px; background: var(--bg-primary); padding: 4px; border-radius: 12px; border: 1px solid var(--border); }
.tab { flex: 1; padding: 10px 14px; border-radius: 8px; border: none; background: transparent; font-weight: 500; cursor: pointer; font-size: 13px; color: var(--text-muted); transition: all 0.2s; }
.tab:hover:not(.active) { color: var(--text-primary); background: var(--bg-tertiary); }
.tab.active { color: white; background: linear-gradient(135deg, #6366f1, #8b5cf6); box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3); font-weight: 600; }

/* Chips */
.chip { padding: 8px 14px; border-radius: 6px; border: 1px solid var(--border); background: var(--bg-tertiary); font-weight: 500; font-size: 12px; cursor: pointer; transition: border-color 0.15s; }
.chip:hover { border-color: var(--border-hover); }
.chip.primary { background: var(--accent); border-color: var(--accent); color: white; }

/* Responsive */
@media (max-width: 980px) {
  .container { grid-template-columns: 1fr; }
  .panel { min-height: 48vh; }
}

/* Health badges */
.healthBadge { display: inline-flex; align-items: center; padding: 5px 10px; border-radius: 6px; border: 1px solid; font-size: 11px; font-weight: 500; }
.healthPill { padding: 3px 8px; border-radius: 4px; font-size: 10px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.02em; }
.healthPill.small { padding: 2px 6px; font-size: 9px; }
.healthPill.safe { background: rgba(63, 185, 80, .12); color: var(--success); border: 1px solid rgba(63, 185, 80, .2); }
.healthPill.drift { background: rgba(210, 153, 34, .12); color: var(--warning); border: 1px solid rgba(210, 153, 34, .2); }
.healthPill.structural { background: rgba(210, 153, 34, .2); color: var(--warning); border: 1px solid rgba(210, 153, 34, .3); }
.healthPill.stress { background: rgba(248, 81, 73, .12); color: var(--danger); border: 1px solid rgba(248, 81, 73, .2); }

/* Layer dots */
.layerHeader { display: flex; align-items: center; gap: 6px; margin-bottom: 4px; }
.layerDot { width: 6px; height: 6px; border-radius: 50%; display: inline-block; }
.layerDot.foundation { background: var(--success); }
.layerDot.growth { background: var(--accent); }
.layerDot.upside { background: var(--warning); }
.layerDot.faded { opacity: 0.4; }

/* Action log */
.actionLog { display: flex; flex-direction: column; gap: 0; font-family: ui-monospace, 'SF Mono', monospace; font-size: 11px; line-height: 1.7; }
.actionLogEmpty { padding: 20px; text-align: center; }
.logEntry { padding: 6px 0; color: var(--text-secondary); border-bottom: 1px solid var(--border); }
.logEntry:last-child { border-bottom: none; }
.logEntry.drift { border-left: 2px solid var(--warning); padding-left: 8px; margin-left: -2px; }
.logEntry.structural { border-left: 2px solid var(--danger); padding-left: 8px; margin-left: -2px; }
.logBoundaryDot { display: inline-block; width: 6px; height: 6px; border-radius: 50%; margin-right: 6px; }
.logBoundaryDot.drift { background: var(--warning); }
.logBoundaryDot.structural { background: var(--danger); }

/* Portfolio value card */
.portfolioValueCard { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin-bottom: 12px; }
.portfolioValueLabel { font-size: 12px; font-weight: 600; color: var(--text-muted); letter-spacing: 0.05em; margin-bottom: 8px; }
.portfolioValueAmount { font-size: 32px; font-weight: 700; background: linear-gradient(135deg, #6366f1, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 16px; }
.portfolioBreakdown { display: flex; gap: 12px; }
.breakdownCard { flex: 1; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 12px; padding: 14px 16px; }
.breakdownCardIcon { font-size: 16px; margin-bottom: 4px; }
.breakdownCardLabel { font-size: 12px; color: var(--text-muted); margin-bottom: 4px; }
.breakdownCardValue { font-size: 16px; font-weight: 600; color: var(--text-primary); }
.sectionTitle { font-size: 12px; font-weight: 600; color: var(--text-muted); letter-spacing: 0.05em; margin-bottom: 12px; }
.portfolioValue { font-size: 28px; font-weight: 600; color: var(--text-primary); }

/* Footer actions */
.footerActions { display: flex; flex-direction: column; gap: 10px; }
.footerRowPrimary { display: flex; gap: 8px; flex-wrap: wrap; }
.footerRowSecondary { display: flex; gap: 8px; }
.resetBtn { color: var(--text-muted); opacity: 0.6; }
.resetBtn:hover { color: var(--danger); border-color: var(--danger); background: rgba(248, 81, 73, 0.08); opacity: 1; }

/* Issue 8: More menu dropdown */
.moreMenuContainer { position: relative; }
.moreMenuDropdown { position: absolute; bottom: 100%; left: 0; margin-bottom: 4px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; box-shadow: var(--shadow-md); min-width: 160px; z-index: 100; overflow: hidden; }
.moreMenuItem { display: flex; align-items: center; gap: 8px; width: 100%; padding: 12px 16px; border: none; background: none; color: var(--text-primary); font-size: 13px; cursor: pointer; text-align: left; transition: background 0.15s; }
.moreMenuItem:hover { background: var(--bg-tertiary); }
.moreMenuItem:first-child { border-bottom: 1px solid var(--border); }

/* Toast */
.toastContainer { position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%); display: flex; flex-direction: column; gap: 8px; z-index: 900; pointer-events: none; }
.toast { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 12px; padding: 14px 24px; font-size: 14px; font-weight: 500; color: var(--text-primary); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4); animation: toastIn 0.3s ease, toastOut 0.3s ease 3.7s forwards; pointer-events: auto; }
.toast.success { border-left: 3px solid var(--success); }
@keyframes toastIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
@keyframes toastOut { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-20px); } }

/* Questionnaire */
.questionnaireHeader { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.q-card { border: 1px solid var(--border); border-radius: 12px; padding: 14px; background: var(--bg-tertiary); }
.q-title { font-family: var(--font-farsi); font-weight: 500; margin-bottom: 6px; line-height: var(--farsi-line-height); font-size: 15px; direction: rtl; text-align: right; letter-spacing: var(--farsi-letter-spacing); }
.q-english { font-size: 11px; color: var(--text-muted); margin-bottom: 10px; font-style: italic; text-align: left; direction: ltr; }
.q-options { display: flex; flex-direction: column; gap: 8px; }
.opt { appearance: none; border: 1px solid var(--border); background: var(--bg-secondary); color: var(--text-primary); padding: 12px 14px; border-radius: 8px; font-weight: 400; cursor: pointer; text-align: right; direction: rtl; font-family: var(--font-farsi); line-height: var(--farsi-line-height); letter-spacing: var(--farsi-letter-spacing); transition: border-color 0.15s, background 0.15s; }
.opt:hover { border-color: var(--accent-border); background: var(--bg-tertiary); }
.opt-english { font-size: 10px; color: var(--text-muted); margin-top: 4px; text-align: left; direction: ltr; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }

/* Consent */
.consentCard { border: 1px solid var(--border); border-radius: 12px; padding: 16px; background: var(--bg-tertiary); }
.consentHeader { font-weight: 600; margin-bottom: 8px; font-size: 14px; }
.consentInstruction { font-size: 12px; color: var(--text-secondary); margin-bottom: 10px; }
.consentSentence { background: var(--bg-primary); border-radius: 8px; padding: 12px; margin-bottom: 12px; border: 1px solid var(--border); }
.sentenceFa { font-family: var(--font-farsi); font-weight: 500; font-size: 14px; line-height: var(--farsi-line-height); direction: rtl; text-align: right; letter-spacing: var(--farsi-letter-spacing); }
.sentenceEn { font-size: 11px; color: var(--text-muted); margin-top: 6px; font-style: italic; text-align: left; direction: ltr; }
.consentCard input[dir="rtl"] { font-family: var(--font-farsi); text-align: right; line-height: var(--farsi-line-height); letter-spacing: var(--farsi-letter-spacing); }
.consentFlow { display: flex; flex-direction: column; min-height: 280px; max-height: 400px; }
.chatMessages { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 12px; margin-bottom: 12px; }
.chatMessage.bot { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 12px; padding: 14px; }
.messageContent { white-space: pre-line; line-height: 1.7; font-size: 13px; }
.chatInputArea { margin-top: auto; flex-shrink: 0; }
.consentInputSection { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 12px; padding: 16px; }
.consentPrompt { font-size: 14px; font-weight: 500; color: var(--text-primary); margin-bottom: 12px; }
.consentTextFarsi { font-size: 16px; font-weight: 500; color: var(--text-primary); text-align: right; direction: rtl; padding: 12px; background: var(--bg-primary); border-radius: 8px; margin-bottom: 4px; font-family: var(--font-farsi); line-height: var(--farsi-line-height); }
.consentTextEnglish { font-size: 12px; color: var(--text-muted); font-style: italic; margin-bottom: 16px; }
.consentInput { width: 100%; padding: 12px 14px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary); font-size: 14px; direction: rtl; text-align: right; margin-bottom: 16px; font-family: var(--font-farsi); line-height: var(--farsi-line-height); outline: none; transition: border-color 0.15s; }
.consentInput:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(61, 127, 255, 0.1); }
.consentInput::placeholder { color: var(--text-muted); direction: ltr; text-align: left; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }

/* Action card */
.actionCard { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 12px; padding: 14px; }
.actionTitle { font-weight: 500; font-size: 12px; margin-bottom: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.03em; }

/* Preview */
.previewPanel { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 12px; padding: 14px; }
.previewTitle { font-weight: 500; font-size: 12px; margin-bottom: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.03em; }
.previewCard { border: 1px solid var(--border); border-radius: 10px; padding: 14px; background: var(--bg-secondary); }
.previewGrid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
.previewLabel { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.04em; margin-bottom: 4px; }
.previewLayers { font-size: 13px; font-weight: 500; }
.previewTotal { font-size: 12px; color: var(--text-secondary); margin-top: 4px; }
.projectedBoundary { display: flex; align-items: center; gap: 8px; margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border); }
.projectedLabel { font-size: 11px; color: var(--text-muted); }
.previewPlaceholder { opacity: 0.5; }

/* Simple summary for non-allocation actions */
.simpleSummary { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 10px; padding: 14px; }
.summaryRow { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border); }
.summaryRow:last-child { border-bottom: none; }
.summaryLabel { font-size: 13px; color: var(--text-secondary); }
.summaryValue { font-size: 14px; font-weight: 500; color: var(--text-primary); }

/* Validation */
.validationDisplay { margin-top: 10px; }
.validationError { padding: 10px 12px; border-radius: 8px; background: rgba(248, 81, 73, .08); border: 1px solid rgba(248, 81, 73, .2); color: var(--danger); font-size: 12px; margin-bottom: 6px; }
.validationWarning { padding: 10px 12px; border-radius: 8px; background: rgba(210, 153, 34, .08); border: 1px solid rgba(210, 153, 34, .2); color: var(--warning); font-size: 12px; margin-bottom: 6px; }

/* Ledger / History */
.ledgerList { display: flex; flex-direction: column; gap: 8px; }
.ledgerEntry { border: 1px solid var(--border); border-radius: 10px; padding: 12px; background: var(--bg-secondary); transition: border-color 0.15s; }
.ledgerEntry:hover { border-color: var(--border-hover); }
.ledgerEntry.structural { border-left: 3px solid #f59e0b; }
.ledgerEntry.stress { border-left: 3px solid #ef4444; }
.ledgerHeader { display: flex; align-items: center; gap: 8px; }
.ledgerIcon { font-size: 12px; width: 20px; font-weight: 700; }
.ledgerIcon.trade-buy { color: var(--success); }
.ledgerIcon.trade-sell { color: var(--danger); }
.ledgerIcon.action-success { color: var(--success); }
.ledgerIcon.funds-add { color: var(--success); }
.ledgerIcon.action-rebalance { color: var(--accent); }
.ledgerIcon.action-protect { color: var(--accent); }
.ledgerIcon.action-loan { color: var(--warning); }
.ledgerAction { font-weight: 500; font-size: 13px; flex: 1; }
.ledgerTime { color: var(--text-muted); font-size: 11px; }
.ledgerExpand { color: var(--text-muted); font-size: 14px; width: 20px; text-align: center; }
.ledgerBoundary { display: flex; align-items: center; gap: 6px; margin-top: 8px; flex-wrap: wrap; }
.ledgerAmount { font-weight: 500; font-size: 12px; color: var(--text-secondary); margin-left: auto; margin-right: 8px; }
.ledgerIntro { font-size: 12px; color: var(--text-muted); margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border); }
.ledgerId { font-size: 10px; color: var(--text-muted); margin-top: 12px; font-family: ui-monospace, 'SF Mono', monospace; }
.ledgerImpact { padding: 12px; background: var(--bg-primary); border-radius: 8px; margin-top: 12px; }
.impactRow { display: flex; justify-content: space-between; font-size: 13px; padding: 4px 0; }
.impactLabel { color: var(--text-secondary); }
.impactValue { font-weight: 500; color: var(--text-primary); }
.impactConstraints { margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); }
.constraintNote { font-size: 12px; color: var(--warning); padding: 2px 0; }
.emptyLedger { text-align: center; padding: 40px 20px; }
.emptyIcon { font-size: 32px; margin-bottom: 12px; opacity: 0.5; }
.emptyText { font-size: 14px; color: var(--text-secondary); margin-bottom: 4px; }
.emptySubtext { font-size: 12px; color: var(--text-muted); }

/* Issue 18: Empty states with CTAs */
.emptyState { text-align: center; padding: 32px 20px; }
.emptyState .emptyIcon { font-size: 40px; margin-bottom: 16px; opacity: 0.6; }
.emptyState .emptyTitle { font-size: 16px; font-weight: 500; color: var(--text-primary); margin-bottom: 8px; }
.emptyState .emptyDescription { font-size: 13px; color: var(--text-secondary); margin-bottom: 20px; line-height: 1.5; max-width: 280px; margin-left: auto; margin-right: auto; }
.emptyState .btn { margin-top: 8px; }

/* Issue 17: Loan header summary */
.loanHeaderSummary { font-size: 13px; color: var(--text-secondary); margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border); }

/* History */
.historyList { display: flex; flex-direction: column; gap: 0; }
.historyGroup { margin-bottom: 24px; }
.historyGroup:last-child { margin-bottom: 0; }
.historyDateHeader { font-size: 12px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; padding: 8px 0; border-bottom: 1px solid var(--border); margin-bottom: 8px; }
.historyEntryDetails { padding: 12px 16px 12px 40px; background: var(--bg-secondary); border-radius: 0 0 8px 8px; margin-top: -4px; border: 1px solid var(--border); border-top: none; }
.statusChange { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
.statusLabel { font-size: 11px; color: var(--text-muted); }
.layerChange { display: flex; flex-direction: column; gap: 4px; }
.changeRow { display: flex; align-items: center; gap: 8px; font-size: 12px; }
.changeLabel { font-size: 11px; color: var(--text-muted); min-width: 50px; }

/* Boundary pills */
.boundaryPill { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.03em; }
.boundaryPill.safe { background: rgba(52, 211, 153, 0.15); color: #34d399; }
.boundaryPill.drift { background: rgba(96, 165, 250, 0.15); color: #60a5fa; }
.boundaryPill.structural { background: rgba(251, 191, 36, 0.15); color: #fbbf24; }
.boundaryPill.stress { background: rgba(248, 113, 113, 0.15); color: #f87171; }

/* Hints */
.borrowHint, .premiumHint { font-size: 11px; color: var(--text-secondary); margin-top: 6px; padding: 8px 10px; background: var(--bg-primary); border-radius: 6px; border: 1px solid var(--border); }

/* Loans */
.loanItem { background: var(--bg-secondary); border: 1px solid rgba(210, 153, 34, .3); border-left: 3px solid var(--warning); }
.loanAmount { font-size: 20px; font-weight: 600; }
.loanDetails { font-size: 12px; color: var(--text-secondary); margin-top: 4px; }
.loanUsage { font-size: 12px; color: var(--text-muted); margin-top: 4px; }
.liquidationValue { font-size: 16px; font-weight: 500; color: var(--warning); }
.loanStatus { margin-top: 12px; padding: 10px 14px; border-radius: 8px; font-size: 13px; font-weight: 500; }
.loanStatusWarning { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
.loanStatusCritical { background: rgba(239, 68, 68, 0.15); color: #f87171; }
.loanHealthIndicator { display: flex; align-items: center; gap: 8px; margin-top: 4px; }
.loanHealthBar { flex: 1; height: 6px; background: var(--bg-primary); border-radius: 3px; overflow: hidden; }
.loanHealthFill { height: 100%; border-radius: 3px; transition: width 0.3s, background 0.3s; }
.loanHealthFill.healthy { background: var(--success); }
.loanHealthFill.warning { background: var(--warning); }
.loanHealthFill.critical { background: var(--danger); }
.loanHealthText { font-size: 11px; font-weight: 500; min-width: 40px; text-align: right; }
.loanHealthText.healthy { color: var(--success); }
.loanHealthText.warning { color: var(--warning); }
.loanHealthText.critical { color: var(--danger); }

/* Issue 5: Redesigned loan cards with health bar */
.loanCards { display: flex; flex-direction: column; gap: 12px; }
.loanCard { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 12px; padding: 16px; }
.loanCard.critical { border-color: rgba(239, 68, 68, 0.4); }
.loanCard.warning { border-color: rgba(249, 115, 22, 0.4); }
.loanCard.caution { border-color: rgba(251, 191, 36, 0.3); }
.loanCardHeader { margin-bottom: 12px; }
.loanCardTitle { display: flex; flex-direction: column; gap: 2px; }
.loanLabel { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-muted); }
.loanCollateral { font-size: 14px; font-weight: 500; color: var(--text-primary); }
.loanCardAmount { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
.loanCardAmount .amountLabel { font-size: 13px; color: var(--text-secondary); }
.loanCardAmount .amountValue { font-size: 20px; font-weight: 600; color: var(--text-primary); }
.loanHealthSection { margin-bottom: 12px; }
.healthBarTrack { height: 8px; background: var(--bg-primary); border-radius: 4px; overflow: hidden; }
.healthBarFill { height: 100%; border-radius: 4px; transition: width 0.3s ease; }
.healthLabelRow { display: flex; justify-content: space-between; align-items: center; margin-top: 8px; }
.healthPercent { font-size: 12px; font-weight: 600; }
.healthLimit { font-size: 11px; color: var(--text-muted); }
.loanWarning { display: flex; align-items: flex-start; gap: 8px; padding: 10px 12px; border-radius: 8px; margin-top: 12px; }
.loanWarning.critical { background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.2); }
.loanWarning.warning { background: rgba(249, 115, 22, 0.1); border: 1px solid rgba(249, 115, 22, 0.2); }
.loanWarning .warningIcon { font-size: 14px; flex-shrink: 0; }
.loanWarning .warningText { font-size: 12px; color: var(--text-primary); line-height: 1.4; }

/* Repay */
.repayDetails { background: var(--bg-primary); border-radius: 10px; padding: 12px; border: 1px solid var(--border); }
.repayRow { display: flex; justify-content: space-between; font-size: 12px; padding: 4px 0; }

/* Modal */
.modalOverlay { position: fixed; inset: 0; background: rgba(0, 0, 0, .7); display: flex; align-items: center; justify-content: center; z-index: 1000; }
.modal { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 16px; padding: 24px; max-width: 400px; width: 90%; box-shadow: var(--shadow-md); }
.modalHeader { font-weight: 600; font-size: 18px; color: var(--text-primary); margin-bottom: 12px; }
.modalBody { margin-bottom: 20px; }
.modalMessage { margin: 0; font-size: 14px; color: var(--text-secondary); line-height: 1.5; }
.modalFooter { display: flex; gap: 12px; justify-content: flex-end; }

/* Onboarding */
.onboardingPanel { height: 100%; display: flex; flex-direction: column; gap: 12px; }

/* Issue 11: Onboarding progress steps */
.onboardingProgress { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 10px; padding: 14px 16px; }
.progressSteps { display: flex; justify-content: space-between; }
.progressStep { display: flex; flex-direction: column; align-items: center; gap: 6px; flex: 1; }
.progressStep .stepNumber { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; background: var(--bg-primary); color: var(--text-muted); border: 2px solid var(--border); transition: all 0.2s; }
.progressStep .stepLabel { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.03em; }
.progressStep.current .stepNumber { background: var(--accent); border-color: var(--accent); color: white; }
.progressStep.current .stepLabel { color: var(--text-primary); font-weight: 500; }
.progressStep.completed .stepNumber { background: var(--success); border-color: var(--success); color: white; }
.progressStep.completed .stepLabel { color: var(--text-secondary); }
.welcomeCard { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 14px; padding: 24px; text-align: center; }
.welcomeIcon { font-size: 48px; margin-bottom: 14px; }
.welcomeCard h2 { margin: 0 0 8px 0; font-weight: 600; font-size: 18px; color: var(--text-primary); }
.welcomeCard p { color: var(--text-secondary); margin: 0 0 16px 0; font-size: 13px; }
.welcomeFeatures { text-align: left; }
.featureItem { display: flex; align-items: center; gap: 10px; padding: 10px 0; border-bottom: 1px solid var(--border); }
.featureItem:last-child { border-bottom: none; }
.welcomeScreen { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; text-align: center; padding: 40px 24px; }
.welcomeLogo { width: 64px; height: 64px; background: var(--accent); border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 28px; font-weight: 700; color: white; margin-bottom: 24px; }
.welcomeTitle { font-size: 28px; font-weight: 600; color: var(--text-primary); margin: 0 0 8px 0; }
.welcomeMotto { font-size: 16px; color: var(--text-secondary); margin: 0 0 8px 0; font-weight: 400; }
.welcomeTagline { font-size: 13px; color: var(--text-muted); margin: 0 0 32px 0; }
.welcomeCta { padding: 12px 40px; font-size: 14px; }
.welcomeValues { display: flex; flex-direction: column; gap: 8px; margin-bottom: 32px; }
.welcomeValues p { font-size: 15px; color: var(--text-secondary); margin: 0; }

/* Progress */
.progressCard { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 14px; padding: 20px; text-align: center; }
.progressCard h3 { margin: 0 0 16px 0; font-size: 14px; font-weight: 500; }
.bigProgress { position: relative; width: 100px; height: 100px; margin: 0 auto 16px; }
.progressRing { width: 100%; height: 100%; }
.progressText { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-weight: 600; font-size: 18px; }

/* Layer preview */
.layerPreviewCard { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 12px; padding: 14px; }
.layerPreviewCard h4 { margin: 0 0 12px 0; font-size: 12px; text-transform: uppercase; letter-spacing: 0.04em; color: var(--text-muted); font-weight: 500; }
.layerPreviewRow { display: flex; align-items: flex-start; gap: 10px; margin-bottom: 10px; }
.layerPreviewRow:last-child { margin-bottom: 0; }
.layerPreviewName { font-weight: 600; font-size: 13px; color: var(--text-primary); }
.layerPreviewTagline { font-size: 12px; color: var(--accent); margin-top: 2px; font-weight: 500; }
.layerPreviewDesc { font-size: 11px; color: var(--text-secondary); margin-top: 2px; }

/* Allocation preview */
.allocationPreviewCard { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 12px; padding: 14px; }
.allocationPreviewCard h3 { margin: 0 0 14px 0; font-size: 12px; text-transform: uppercase; letter-spacing: 0.04em; color: var(--text-muted); font-weight: 500; }
.allocationViz { display: flex; gap: 2px; height: 40px; margin-bottom: 16px; border-radius: 6px; overflow: hidden; }
.allocationBar { display: flex; flex-direction: column; align-items: center; justify-content: center; }
.allocationBar.foundation { background: var(--success); }
.allocationBar.growth { background: var(--accent); }
.allocationBar.upside { background: var(--warning); }
.barIcon { font-size: 14px; }
.barPct { font-size: 11px; font-weight: 500; }
.allocationDetails { display: flex; flex-direction: column; gap: 10px; }
.detailHeader { display: flex; align-items: center; gap: 8px; }
.detailName { font-weight: 500; font-size: 12px; flex: 1; }
.detailPct { font-weight: 500; font-size: 12px; }
.detailAssets { font-size: 11px; color: var(--text-muted); margin-left: 14px; margin-top: 2px; }
.allocationLegend { display: flex; flex-direction: column; gap: 10px; margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
.legendRow { display: flex; justify-content: space-between; align-items: center; }
.legendLeft { display: flex; align-items: center; gap: 8px; }
.legendName { font-size: 14px; font-weight: 500; color: var(--text-primary); }
.legendPct { font-size: 14px; font-weight: 600; color: var(--text-primary); }
.allocationAssets { display: flex; flex-direction: column; gap: 6px; }
.assetRow { display: flex; align-items: center; gap: 8px; }
.assetList { font-size: 12px; color: var(--text-muted); }

/* Investment preview */
.investPreviewCard { background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 12px; padding: 14px; }
.investPreviewCard h3 { margin: 0 0 14px 0; font-size: 12px; text-transform: uppercase; letter-spacing: 0.04em; color: var(--text-muted); font-weight: 500; }
.investTotal { text-align: center; margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
.investBreakdown { display: flex; flex-direction: column; gap: 8px; }
.investPreviewDonut { display: flex; justify-content: center; margin-bottom: 16px; }
.breakdownRow { display: flex; justify-content: space-between; align-items: center; }
.breakdownLeft { display: flex; align-items: center; gap: 8px; }
.breakdownAmount { font-weight: 500; font-size: 13px; }
.breakdownRight { text-align: right; }
.investPlaceholder { padding: 30px; text-align: center; }
.investWarning { font-size: 12px; color: var(--warning); margin-top: 6px; }
.investMinHint { font-size: 11px; color: var(--text-muted); margin-top: 8px; }
.investMinimum { font-size: 12px; color: var(--text-secondary); margin-top: 8px; margin-bottom: 4px; }
.quickAmountsLabel { font-size: 12px; color: var(--text-muted); margin-bottom: 8px; }
.placeholderTotal { text-align: center; padding: 20px 0; border-bottom: 1px solid var(--border); margin-bottom: 16px; }
.placeholderValue { font-size: 24px; font-weight: 600; color: var(--text-muted); letter-spacing: 2px; }
.placeholderLabel { font-size: 12px; color: var(--text-muted); margin-top: 4px; }
.placeholderBreakdown { display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px; }
.placeholderRow { display: flex; justify-content: space-between; align-items: center; }
.placeholderLeft { display: flex; align-items: center; gap: 8px; }
.placeholderName { font-size: 13px; color: var(--text-muted); }
.placeholderAmount { font-size: 13px; font-weight: 500; color: var(--text-muted); letter-spacing: 1px; }
.placeholderHint { text-align: center; font-size: 12px; color: var(--text-muted); padding: 12px; background: var(--bg-primary); border-radius: 8px; }

/* Quick amounts */
.quickAmounts { display: flex; gap: 8px; margin-bottom: 12px; }
.quickAmountBtn { padding: 8px 16px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-primary); color: var(--text-secondary); font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.15s ease; }
.quickAmountBtn:hover { border-color: var(--accent); color: var(--text-primary); }
.quickAmountBtn.selected { background: var(--accent); border-color: var(--accent); color: white; }

/* Holdings */
.holdingsList { display: flex; flex-direction: column; gap: 8px; }
.holdingRow { display: flex; align-items: center; padding: 14px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 10px; margin-bottom: 0; border-left-width: 3px; border-left-style: solid; gap: 12px; }
.holdingRow.layer-foundation { border-left-color: #34d399; }
.holdingRow.layer-growth { border-left-color: #60a5fa; }
.holdingRow.layer-upside { border-left-color: #fbbf24; }
.holdingRow.assetEmpty { opacity: 0.5; background: repeating-linear-gradient(45deg, var(--bg-secondary), var(--bg-secondary) 10px, rgba(255, 255, 255, 0.02) 10px, rgba(255, 255, 255, 0.02) 20px); }
.holdingRow.assetEmpty .holdingName { color: var(--text-muted); }
.holdingRow.assetEmpty .holdingValue { color: var(--text-muted); }
.holdingInfo { flex: 1; min-width: 0; }
.holdingName { font-weight: 500; font-size: 14px; color: var(--text-primary); }
.holdingLayer { font-size: 12px; color: var(--text-secondary); display: flex; align-items: center; gap: 6px; margin-top: 2px; }
.holdingValue { font-weight: 500; font-size: 14px; color: var(--text-primary); text-align: right; min-width: 100px; }
.holdingActions { display: flex; gap: 6px; align-items: center; }

/* Sell button frozen tooltip */
.sellButtonWrapper { position: relative; }
.frozenTooltip { position: absolute; top: 100%; left: 50%; transform: translateX(-50%); margin-top: 6px; padding: 6px 10px; background: var(--bg-elevated); border: 1px solid var(--danger); border-radius: 6px; font-size: 11px; color: var(--danger); white-space: nowrap; z-index: 10; opacity: 0; pointer-events: none; transition: opacity 0.15s; }
.sellButtonWrapper:hover .frozenTooltip { opacity: 1; }

/* Drift warning banner */
.driftBanner { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.25); border-radius: 10px; margin-bottom: 12px; }
.driftBanner.attention { background: rgba(248, 81, 73, 0.1); border-color: rgba(248, 81, 73, 0.25); }
.driftBanner .driftIcon { font-size: 18px; flex-shrink: 0; }
.driftBanner .driftText { flex: 1; font-size: 13px; color: var(--text-primary); }
.driftBanner .driftText strong { font-weight: 600; }
.driftBanner .driftAction { font-size: 12px; padding: 6px 12px; }

/* Issue 3: Collapsible layer sections */
.layerSection { margin-bottom: 12px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; }
.layerSection:last-child { margin-bottom: 0; }
.layerSection.expanded { border-color: var(--accent-border); }
.layerSectionHeader { display: flex; align-items: center; gap: 10px; padding: 14px 16px; cursor: default; }
.layerSectionHeader.collapsible { cursor: pointer; transition: background 0.15s; }
.layerSectionHeader.collapsible:hover { background: var(--bg-tertiary); }
.layerHeaderContent { flex: 1; display: flex; flex-direction: column; gap: 2px; }
.layerSectionTitle { font-size: 13px; font-weight: 600; color: var(--text-primary); }
.layerHeaderValue { font-size: 12px; color: var(--text-secondary); }
.layerHeaderMeta { display: flex; flex-direction: column; align-items: flex-end; gap: 2px; margin-right: 8px; }
.layerAssetCount { font-size: 11px; color: var(--text-muted); }
.layerStatus { font-size: 11px; font-weight: 500; }
.layerStatus.on-target { color: var(--success); }
.layerStatus.off-target { color: var(--text-muted); }
.expandIcon { font-size: 10px; color: var(--text-muted); width: 16px; text-align: center; }
.layerSection .holdingsList { padding: 0 12px 12px 12px; border-top: 1px solid var(--border); margin-top: 0; padding-top: 12px; }

/* Overflow menu */
.overflowContainer { position: relative; }
.overflowTrigger { padding: 6px 10px; font-size: 14px; letter-spacing: 1px; }
.overflowMenu { position: absolute; top: 100%; right: 0; margin-top: 4px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; box-shadow: var(--shadow-md); min-width: 140px; z-index: 100; overflow: hidden; }
.overflowItem { display: flex; align-items: center; gap: 8px; width: 100%; padding: 10px 14px; border: none; background: none; color: var(--text-primary); font-size: 13px; cursor: pointer; text-align: left; }
.overflowItem:hover { background: var(--bg-tertiary); }
.overflowItem:disabled { opacity: 0.4; cursor: not-allowed; }
.overflowIcon { font-size: 14px; }

/* Protection */
.protectionItem { background: var(--bg-secondary); border: 1px solid var(--accent-border); border-left: 3px solid var(--accent); }
.protectionProgress { margin-top: 8px; }
.protectionProgressBar { height: 4px; background: var(--bg-primary); border-radius: 2px; overflow: hidden; }
.protectionProgressFill { height: 100%; background: var(--accent); border-radius: 2px; transition: width 0.3s; }
.protectionProgressText { display: flex; justify-content: space-between; font-size: 10px; color: var(--text-muted); margin-top: 4px; }

/* Issue 14: Protection header context */
.protectionHeaderContext { font-size: 13px; color: var(--text-secondary); margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border); }

/* Protection cancel confirmation */
.cancelConfirm { display: flex; align-items: center; gap: 6px; }
.cancelText { font-size: 12px; color: var(--text-secondary); margin-right: 4px; }
.btn.tiny.danger { background: transparent; border-color: var(--danger); color: var(--danger); }
.btn.tiny.danger:hover { background: rgba(248, 81, 73, 0.15); }

/* Expired protections */
.protectionItem.expired { opacity: 0.6; border-color: var(--border); border-left-color: var(--text-muted); }
.expiredBadge { display: inline-block; margin-left: 8px; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 500; background: rgba(139, 148, 158, 0.15); color: var(--text-muted); text-transform: uppercase; }
.expiredSection { margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border); }
.expiredHeader { font-size: 11px; font-weight: 500; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.03em; margin-bottom: 10px; }
.expiredDate { font-size: 11px; color: var(--text-muted); margin-top: 6px; }

/* Rebalance */
.rebalanceConstraintWarning { display: flex; gap: 12px; padding: 14px; background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 10px; margin-top: 12px; }
.warningIcon { font-size: 20px; flex-shrink: 0; }
.warningMessages { display: flex; flex-direction: column; gap: 6px; }
.warningMessage { font-size: 13px; color: var(--text-primary); line-height: 1.4; }
.warningMessage:first-child { font-weight: 500; }
.rebalanceTradesCard { background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 10px; padding: 12px; margin-top: 12px; }
.rebalanceTradesHeader { font-size: 11px; font-weight: 500; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.03em; margin-bottom: 10px; }
.rebalanceTradesList { display: flex; flex-direction: column; gap: 8px; margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border); }

/* Issue 9: Collapsible rebalance summary */
.rebalanceSummary { display: flex; flex-direction: column; gap: 4px; }
.rebalanceSummary .summaryLine { font-size: 13px; font-weight: 500; }
.rebalanceSummary .summaryLine.sell { color: var(--danger); }
.rebalanceSummary .summaryLine.buy { color: var(--success); }
.expandTradesBtn { margin-top: 10px; padding: 8px 0; border: none; background: none; color: var(--accent); font-size: 12px; cursor: pointer; text-align: center; width: 100%; transition: color 0.15s; }
.expandTradesBtn:hover { color: #5a93ff; }
.rebalanceTradeRow { display: flex; align-items: center; gap: 8px; font-size: 13px; }
.tradeName { flex: 1; color: var(--text-primary); }
.tradeAmount { font-weight: 500; }
.tradeAmount.buy { color: var(--success); }
.tradeAmount.sell { color: var(--danger); }
.rebalanceCashSummary { margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); font-size: 12px; color: var(--text-secondary); }
.rebalanceNoTrades { padding: 16px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 10px; margin-top: 12px; text-align: center; }
.rebalanceNoTrades .noTradesIcon { font-size: 24px; margin-bottom: 8px; opacity: 0.5; }
.rebalanceNoTrades .noTradesText { font-size: 13px; color: var(--text-secondary); }
.rebalanceNoTrades .noTradesHint { font-size: 11px; color: var(--text-muted); margin-top: 4px; }

/* Header badges */
.headerBadge { padding: 6px 12px; border-radius: 6px; font-size: 13px; font-weight: 500; }
.badge-success { background: rgba(52, 211, 153, 0.15); color: #34d399; border: 1px solid rgba(52, 211, 153, 0.3); }
.badge-warning { background: rgba(251, 191, 36, 0.15); color: #fbbf24; border: 1px solid rgba(251, 191, 36, 0.3); }
.badge-info { background: rgba(139, 92, 246, 0.15); color: #a78bfa; border: 1px solid rgba(139, 92, 246, 0.3); }

/* Stress mode */
.stressModeToggle { padding: 5px 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--bg-tertiary); color: var(--text-muted); font-size: 11px; font-weight: 500; cursor: pointer; transition: all 0.15s; }
.stressModeToggle:hover { border-color: var(--border-hover); color: var(--text-secondary); }
.stressModeToggle.active { background: rgba(239, 68, 68, 0.15); border-color: rgba(239, 68, 68, 0.3); color: #f87171; }

/* Donut chart */
.donutChartContainer { display: flex; justify-content: center; margin-bottom: 20px; }
.donutChart { transform: rotate(-90deg); }
.donutCenterLabel { font-size: 10px; fill: var(--text-secondary); font-weight: 500; transform: rotate(90deg); transform-origin: 60px 60px; }

/* Recommendation message */
.recommendationMessage p { margin: 0 0 12px 0; font-size: 13px; }
.recommendationMessage p:last-child { margin: 12px 0 0 0; }
.recommendationLayers { display: flex; flex-direction: column; gap: 8px; padding: 12px; background: var(--bg-primary); border-radius: 8px; margin-bottom: 4px; }
.recommendationLayer { display: flex; align-items: center; gap: 10px; font-size: 13px; }
.recommendationLayer .layerDot { width: 8px; height: 8px; }
